---
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';
import ChatBotWrapper from '../components/ChatBotWrapper.astro';
import { readFileSync } from 'fs';
import { fileURLToPath } from 'url';
import path from 'path';

// Read critical CSS for inline inclusion
const __filename = fileURLToPath(import.meta.url);
const __dirname = path.dirname(__filename);
const criticalCSS = readFileSync(path.join(__dirname, '../styles/critical.css'), 'utf-8');

export interface Props {
  title: string;
  description?: string;
  keywords?: string;
  ogImage?: string;
  transparentHeader?: boolean;
}

const {
  title,
  description = "Bubbles Enterprise - Especialistas em Soffit e Fascia em Orlando. Construção nova, remoção e substituição, reparos. Orçamentos gratuitos e serviço de qualidade premium.",
  keywords = "soffit installation orlando, fascia repair florida, aluminum soffit orlando, vinyl soffit installation, soffit fascia contractor orlando, home exterior orlando, construction services florida, bubbles enterprise",
  ogImage = "/images/og-image.svg",
  transparentHeader = false
} = Astro.props;

const canonicalURL = new URL(Astro.url.pathname, Astro.site);
---

<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
  <head>
    <meta charset="UTF-8" />
    <meta name="description" content={description} />
    <meta name="keywords" content={keywords} />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
    <meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1" />
    <meta name="author" content="Bubbles Enterprise" />
    <meta name="theme-color" content="#2563eb" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="default" />
    <meta name="format-detection" content="telephone=no" />
    <meta name="mobile-web-app-capable" content="yes" />
    <meta name="application-name" content="Bubbles Enterprise" />
    <meta name="msapplication-TileColor" content="#2563eb" />
    <meta name="msapplication-config" content="/browserconfig.xml" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <link rel="manifest" href="/manifest.webmanifest" />
    <meta name="generator" content={Astro.generator} />
    
    <!-- Canonical URL -->
    <link rel="canonical" href={canonicalURL} />
    
    <!-- Enhanced Open Graph / Facebook for 2025 -->
    <meta property="og:type" content="website" />
    <meta property="og:url" content={canonicalURL} />
    <meta property="og:title" content={title} />
    <meta property="og:description" content={description} />
    <meta property="og:image" content={ogImage} />
    <meta property="og:image:width" content="1200" />
    <meta property="og:image:height" content="630" />
    <meta property="og:image:type" content="image/svg+xml" />
    <meta property="og:image:alt" content="Bubbles Enterprise - Professional Soffit & Fascia Services in Orlando" />
    <meta property="og:site_name" content="Bubbles Enterprise" />
    <meta property="og:locale" content="en_US" />
    <meta property="og:locale:alternate" content="es_US" />
    <meta property="business:contact_data:street_address" content="Orlando Metro Area" />
    <meta property="business:contact_data:locality" content="Orlando" />
    <meta property="business:contact_data:region" content="Florida" />
    <meta property="business:contact_data:postal_code" content="32801" />
    <meta property="business:contact_data:country_name" content="United States" />
    <meta property="business:contact_data:phone_number" content="+1-407-715-1790" />
    
    <!-- Enhanced Twitter Cards for 2025 -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:site" content="@bubblesenterprise" />
    <meta name="twitter:creator" content="@bubblesenterprise" />
    <meta name="twitter:url" content={canonicalURL} />
    <meta name="twitter:title" content={title} />
    <meta name="twitter:description" content={description} />
    <meta name="twitter:image" content={ogImage} />
    <meta name="twitter:image:alt" content="Bubbles Enterprise - Professional Soffit & Fascia Services in Orlando" />
    <meta name="twitter:label1" content="Service Area" />
    <meta name="twitter:data1" content="Orlando, FL Metro Area" />
    <meta name="twitter:label2" content="Phone" />
    <meta name="twitter:data2" content="(407) 715-1790" />
    
    <!-- Preload critical resources for better performance -->
    <link rel="preload" href="/assets/fonts/inter-400.ttf" as="font" type="font/ttf" crossorigin>
    <link rel="preload" href="/assets/fonts/inter-600.ttf" as="font" type="font/ttf" crossorigin>
    <link rel="preload" href="/assets/fonts/poppins-600.ttf" as="font" type="font/ttf" crossorigin>
    <link rel="preload" href="/assets/fonts/poppins-700.ttf" as="font" type="font/ttf" crossorigin>
    <link rel="preload" href="/js/calculator.js" as="script">
    <link rel="preload" href="/images/hero-bg.svg" as="image">
    
    <!-- Load local font CSS with optimized loading -->
    <link rel="stylesheet" href="/assets/fonts/fonts.css" media="print" onload="this.media='all'">
    <noscript><link rel="stylesheet" href="/assets/fonts/fonts.css"></noscript>
    
    <!-- Optimize font loading with font-display swap -->
    <style>
      @font-face {
        font-family: 'Inter';
        font-display: swap;
      }
      @font-face {
        font-family: 'Poppins';
        font-display: swap;
      }
    </style>
    
    <!-- Fallback for no-JS -->
    <noscript>
      <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet" />
      <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet" />
    </noscript>
    
    <!-- Enhanced Schema.org markup for 2025 -->
    <script type="application/ld+json">
      [
        {
          "@context": "https://schema.org",
          "@type": "WebSite",
          "@id": "https://bubblesenterprise.com/#website",
          "url": "https://bubblesenterprise.com",
          "name": "Bubbles Enterprise - Soffit & Fascia Specialists",
          "description": "Professional soffit and fascia installation, repair, and replacement services in Orlando, Florida",
          "publisher": {
            "@id": "https://bubblesenterprise.com/#organization"
          },
          "potentialAction": [
            {
              "@type": "SearchAction",
              "target": {
                "@type": "EntryPoint",
                "urlTemplate": "https://bubblesenterprise.com/search?q={search_term_string}"
              },
              "query-input": "required name=search_term_string"
            }
          ],
          "inLanguage": "en-US"
        },
        {
          "@context": "https://schema.org",
          "@type": ["LocalBusiness", "HomeAndConstructionBusiness", "Contractor"],
          "@id": "https://bubblesenterprise.com/#organization",
        "name": "Bubbles Enterprise",
        "alternateName": "Bubbles Enterprise LLC",
        "description": "Professional soffit and fascia installation, repair, and replacement services in Orlando, Florida. Licensed and insured contractors with over 10 years of experience.",
        "url": "https://bubblesenterprise.com",
        "telephone": "+1-407-715-1790",
        "email": "contact@bubblesenterprise.com",
        "foundingDate": "2014",
        "slogan": "Quality Soffit & Fascia Solutions for Your Home",
        "address": {
          "@type": "PostalAddress",
          "streetAddress": "Orlando Metro Area",
          "addressLocality": "Orlando",
          "addressRegion": "FL",
          "addressCountry": "US",
          "postalCode": "32801"
        },
        "geo": {
          "@type": "GeoCoordinates",
          "latitude": "28.5383",
          "longitude": "-81.3792"
        },
        "openingHours": [
          "Mo-Fr 08:00-18:00",
          "Sa 09:00-16:00"
        ],
        "priceRange": "$$-$$$",
        "paymentAccepted": ["Cash", "Check", "Credit Card", "Financing Available"],
        "currenciesAccepted": "USD",
        "areaServed": [
          {
            "@type": "City",
            "name": "Orlando",
            "sameAs": "https://en.wikipedia.org/wiki/Orlando,_Florida"
          },
          {
            "@type": "City",
            "name": "Winter Park",
            "sameAs": "https://en.wikipedia.org/wiki/Winter_Park,_Florida"
          },
          {
            "@type": "City",
            "name": "Kissimmee",
            "sameAs": "https://en.wikipedia.org/wiki/Kissimmee,_Florida"
          },
          {
            "@type": "City",
            "name": "Altamonte Springs"
          },
          {
            "@type": "City",
            "name": "Apopka"
          }
        ],
        "serviceType": [
          "Soffit Installation",
          "Fascia Repair",
          "Aluminum Soffit",
          "Vinyl Soffit",
          "Home Exterior Services",
          "Construction Services"
        ],
        "hasOfferCatalog": {
          "@type": "OfferCatalog",
          "name": "Soffit and Fascia Services",
          "itemListElement": [
            {
              "@type": "Offer",
              "itemOffered": {
                "@type": "Service",
                "name": "New Soffit Installation",
                "description": "Professional installation of aluminum and vinyl soffit systems for new construction and home improvements",
                "category": "Home Improvement"
              },
              "availability": "https://schema.org/InStock",
              "areaServed": "Orlando, FL Metro Area"
            },
            {
              "@type": "Offer",
              "itemOffered": {
                "@type": "Service",
                "name": "Fascia Repair & Replacement",
                "description": "Expert repair and replacement of damaged fascia boards and trim",
                "category": "Home Repair"
              },
              "availability": "https://schema.org/InStock",
              "areaServed": "Orlando, FL Metro Area"
            },
            {
              "@type": "Offer",
              "itemOffered": {
                "@type": "Service",
                "name": "Free Estimates",
                "description": "Complimentary on-site project estimates and consultations",
                "category": "Consultation"
              },
              "price": "0",
              "priceCurrency": "USD",
              "availability": "https://schema.org/InStock"
            }
          ]
        },
        "aggregateRating": {
          "@type": "AggregateRating",
          "ratingValue": "4.9",
          "bestRating": "5",
          "worstRating": "1",
          "reviewCount": "127",
          "ratingCount": "127"
        },
        "review": [
          {
            "@type": "Review",
            "reviewRating": {
              "@type": "Rating",
              "ratingValue": "5",
              "bestRating": "5"
            },
            "author": {
              "@type": "Person",
              "name": "Sarah Johnson"
            },
            "reviewBody": "Excellent work on our soffit installation. Professional, timely, and great quality."
          }
        ],
        "logo": {
          "@type": "ImageObject",
          "url": "https://bubblesenterprise.com/bubbles_enterprise_logo_large.svg",
          "width": "300",
          "height": "100"
        },
        "image": [
          "https://bubblesenterprise.com/images/og-image.svg"
        ],
        "sameAs": [
          "https://www.facebook.com/bubblesenterprise",
          "https://www.instagram.com/bubblesenterprise",
          "https://www.linkedin.com/company/bubblesenterprise"
        ],
        "contactPoint": [
          {
            "@type": "ContactPoint",
            "telephone": "+1-407-715-1790",
            "contactType": "customer service",
            "availableLanguage": ["English", "Spanish"],
            "areaServed": "US-FL"
          },
          {
            "@type": "ContactPoint",
            "email": "contact@bubblesenterprise.com",
            "contactType": "sales",
            "availableLanguage": ["English", "Spanish"]
          }
        ],
        "makesOffer": {
          "@type": "Offer",
          "itemOffered": {
            "@type": "Service",
            "name": "Soffit and Fascia Services"
          },
          "areaServed": "Orlando, FL Metro Area",
          "availability": "https://schema.org/InStock"
        },
        "knowsAbout": [
          "Soffit Installation",
          "Fascia Repair",
          "Aluminum Siding",
          "Vinyl Soffits",
          "Home Exterior Renovation",
          "Construction Services",
          "Roofline Protection",
          "Ventilation Systems"
        ],
        "hasCredential": {
          "@type": "EducationalOccupationalCredential",
          "name": "Licensed General Contractor",
          "credentialCategory": "Professional License"
        },
        "memberOf": {
          "@type": "Organization",
          "name": "Better Business Bureau",
          "url": "https://www.bbb.org"
        }
        },
         {
           "@context": "https://schema.org",
           "@type": "FAQPage",
           "mainEntity": [
             {
               "@type": "Question",
               "name": "What is soffit and fascia?",
               "acceptedAnswer": {
                 "@type": "Answer",
                 "text": "Soffit is the exposed surface beneath the overhanging section of a roof eave. Fascia is the vertical finishing edge connected to the ends of the rafters, trusses, or the area where the gutter is attached to the roof."
               }
             },
             {
               "@type": "Question",
               "name": "How much does soffit and fascia installation cost in Orlando?",
               "acceptedAnswer": {
                 "@type": "Answer",
                 "text": "Soffit and fascia installation costs in Orlando typically range from $6 to $20 per linear foot, depending on materials (aluminum, vinyl, or wood) and complexity of the project. We provide free estimates for accurate pricing."
               }
             },
             {
               "@type": "Question",
               "name": "Do you provide free estimates for soffit and fascia work?",
               "acceptedAnswer": {
                 "@type": "Answer",
                 "text": "Yes, Bubbles Enterprise provides completely free, no-obligation estimates for all soffit and fascia projects in Orlando and Central Florida. Contact us at (407) 715-1790 to schedule your free consultation."
               }
             },
             {
               "@type": "Question",
               "name": "What areas do you serve in Florida?",
               "acceptedAnswer": {
                 "@type": "Answer",
                 "text": "We serve Orlando, Winter Park, Kissimmee, Altamonte Springs, Apopka, and the entire Central Florida metro area for professional soffit and fascia installation, repair, and replacement services."
               }
             },
             {
               "@type": "Question",
               "name": "How long does soffit and fascia installation take?",
               "acceptedAnswer": {
                 "@type": "Answer",
                 "text": "Most residential soffit and fascia installations are completed within 1-3 days, depending on the size of your home and complexity of the project. We work efficiently while maintaining high quality standards."
               }
             },
             {
               "@type": "Question",
               "name": "What materials do you use for soffit and fascia?",
               "acceptedAnswer": {
                 "@type": "Answer",
                 "text": "We specialize in high-quality aluminum and vinyl soffit and fascia materials that are durable, weather-resistant, and low-maintenance. These materials are ideal for Florida's climate and provide long-lasting protection."
               }
             }
           ]
         }
       ]
    </script>
    
    <title>{title}</title>
    
    <!-- Critical CSS Inline for LCP optimization -->
    <style is:inline set:html={criticalCSS}></style>
    
    <!-- Load non-critical CSS asynchronously with fetchpriority -->
    <link rel="stylesheet" href="/src/styles/global.css">
    
    <!-- Preload critical images for LCP with fetchpriority -->
    <link rel="preload" href="/images/bubbles_enterprise_logo_large.svg" as="image" type="image/svg+xml" fetchpriority="high">
    
    <!-- Preload critical scripts for better INP -->
    <link rel="preload" href="/js/lazy-loader.js" as="script" fetchpriority="high">
    
    <!-- Load lazy loader immediately for INP optimization -->
    <script src="/js/lazy-loader.js" async></script>
    
    <!-- Custom Scripts -->
    <!-- <script src="/js/main.js" is:inline></script> -->
    <script src="/js/calculator.js" is:inline></script>
    <script src="/js/form-security.js" is:inline></script>
    
    <!-- Performance optimization hints -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    
    <!-- Reduce layout shift with aspect ratio hints -->
    <style>
      /* Prevent layout shift for images */
      img { aspect-ratio: attr(width) / attr(height); }
      
      /* Optimize CLS for hero section */
      .hero-section { min-height: 60vh; }
      
      /* Improve INP with faster transitions */
      * { transition-duration: 0.15s; }
    </style>
  </head>
  
  <body class="min-h-screen bg-neutral-white ios-fix">
    
    <!-- Skip to main content for accessibility -->
    <a href="#main-content" class="sr-only focus:not-sr-only focus:absolute focus:top-4 focus:left-4 bg-bubble-blue text-white px-4 py-2 rounded-md z-50">
      Skip to main content
    </a>
    
    <Header transparent={transparentHeader} />
    
    <!-- Main Content -->
    <main id="main-content" class="flex-1">
      <slot />
    </main>
    
    <Footer />
    
    <!-- ChatBot Grok AI -->
    <ChatBotWrapper />
    
  </body>
</html>