import"./hoisted.DV8WBEkX.js";document.addEventListener("DOMContentLoaded",function(){const e=document.querySelector("form"),t=document.getElementById("photos"),n=document.getElementById("photo-preview");let o=[];if(window.crypto&&window.crypto.randomUUID){const e=window.crypto.randomUUID();document.getElementById("csrfToken").value=e,sessionStorage.setItem("_csrf_token",e)}else{const e="csrf_"+Math.random().toString(36).substr(2,9)+"_"+Date.now();document.getElementById("csrfToken").value=e,sessionStorage.setItem("_csrf_token",e)}function r(e){0!==e.length?(n.classList.remove("hidden"),n.innerHTML="",e.forEach((e,t)=>{const o=new FileReader;o.onload=function(o){const r=document.createElement("div");r.className="relative",r.innerHTML=`\n            <img src="${o.target.result}" alt="Preview ${t+1}" class="w-full h-20 object-cover rounded-lg">\n            <button type="button" onclick="removePhoto(${t})" class="absolute -top-2 -right-2 bg-red-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs hover:bg-red-600">\n              ×\n            </button>\n            <p class="text-xs text-center mt-1 truncate">${e.name}</p>\n          `,n.appendChild(r)},o.readAsDataURL(e)})):n.classList.add("hidden")}t&&t.addEventListener("change",function(e){const t=Array.from(e.target.files);if(t.length>5)return void alert("Máximo de 5 fotos permitidas.");const n=t.filter(e=>e.size>10485760?(alert(`Arquivo ${e.name} é muito grande. Máximo 10MB.`),!1):!!e.type.startsWith("image/")||(alert(`Arquivo ${e.name} não é uma imagem válida.`),!1));o=n,r(n)}),window.removePhoto=function(e){o.splice(e,1),r(o);const n=new DataTransfer;o.forEach(e=>n.items.add(e)),t.files=n.files},e&&e.addEventListener("submit",function(t){t.preventDefault();const n=e.querySelectorAll("[required]");let o=!0;if(n.forEach(e=>{e.value.trim()?e.classList.remove("border-red-500"):(e.classList.add("border-red-500"),o=!1)}),o){const t=new FormData(e);fetch("/api/quote",{method:"POST",body:t}).then(e=>e.json()).then(e=>{e.success?window.location.href="/thank-you":alert("Error submitting quote. Please try again.")}).catch(e=>{alert("Error submitting quote. Please try again.")})}else alert("Please fill in all required fields.")})});
